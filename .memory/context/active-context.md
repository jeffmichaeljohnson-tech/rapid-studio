# Active Context - Rapid Studio

**Last Updated**: Auto-generated by Memory Sync Daemon  
**Purpose**: Shared context for Claude AI, Cursor IDE, and development team

---

## 🎯 Current Focus

*This section auto-updates based on recent work*

### Active Sprint
- Setting up memory synchronization system
- Building Docker infrastructure for GPU orchestration
- Implementing SwipeDeck mobile UI

### Current Blockers
- None currently

### Next Milestones
1. Complete Docker image build pipeline
2. Test Runpod GPU deployment
3. Implement SwipeDeck gestures with Reanimated

---

## 📊 Project State

### Repository
- **Branch**: main
- **Last Commit**: *Auto-updated*
- **Modified Files**: *Auto-tracked*

### Infrastructure
- **Docker Status**: Building orchestrator image
- **Services Running**: *Auto-detected*
- **Runpod Fleet**: Not yet deployed

### Mobile App
- **Platform**: Expo SDK 50
- **Router**: Expo Router v2
- **Key Components**: 
  - SwipeDeck (in progress)
  - Rating system (planned)

---

## 🏗️ Architecture Overview

### Mobile (Expo)
```
app/
├── (tabs)/          # Tab navigation
├── index.tsx        # Entry point → SwipeDeck
└── _layout.tsx      # Root layout
```

### Backend (Runpod)
```
orchestrator/        # FastAPI job router
services/
├── runner-gpu/      # SDXL-Turbo generation
├── validator-lite/  # Quick validation
└── validator-full/  # Full BrandScore
```

### Infrastructure
- **Primary GPU**: Runpod RTX 4000 Ada fleet
- **Networking**: Tailscale mesh (MagicDNS + ACLs)
- **Secrets**: Vault for dynamic tokens
- **Monitoring**: Grafana + Prometheus

---

## 📝 Recent Decisions

### ADR-001: Docker Deployment Strategy
- Run Expo dev locally on Mac mini
- Deploy backend services to Runpod via Docker
- Use multi-stage builds for optimization

### ADR-002: Memory Synchronization System
- Auto-save Claude sessions every 10 minutes
- Bidirectional sync with Cursor via GitHub
- Cross-tool context sharing

---

## 🔑 Key Patterns

### SwipeDeck Implementation
```typescript
// Use Reanimated for smooth native-thread animations
const translateX = useSharedValue(0);
const gesture = Gesture.Pan()
  .onChange((event) => {
    translateX.value = event.translationX;
  })
  .onEnd((event) => {
    if (Math.abs(event.translationX) > SWIPE_THRESHOLD) {
      // Submit rating
    }
  });
```

### Rating Loop
```
User swipes → Batch locally → POST /ratings every 10-15 swipes
→ Backend updates embeddings → Generates new batch
→ Fresh images stream back → Improvement visible by swipe ~25
```

### GPU Job Flow
```
POST /jobs → Redis Stream → Runpod worker picks up
→ SDXL-Turbo generates → BrandScore validates
→ Store in S3 → Return URLs → Mobile prefetches
```

---

## 📚 Key Documentation

### Internal Docs
- [Project Overview](../docs/PROJECT_OVERVIEW.md)
- [API Documentation](../docs/api/)
- [Architecture Docs](../docs/architecture/)

### External References
- [Expo Docs](https://docs.expo.dev)
- [Reanimated](https://docs.swmansion.com/react-native-reanimated)
- [Runpod API](https://docs.runpod.io)
- [FastAPI](https://fastapi.tiangolo.com)

---

## 🎓 Context for AI Assistants

### When Claude Sees This File
Claude should understand:
- Current project phase and priorities
- Active blockers and constraints
- Architecture decisions and rationale
- Code patterns to follow
- Recent changes from Cursor

### When Cursor Sees This File
Cursor should understand:
- Recent Claude decisions
- Project structure and conventions
- Current development focus
- Patterns to maintain

---

## 🔄 Sync Status

**Daemon Status**: *Check with `npm run memory:status`*  
**Last Session Save**: *Auto-updated*  
**Last GitHub Sync**: *Auto-updated*  
**Session Count**: *Auto-tracked*

---

*This file is auto-maintained by the Memory Sync Daemon*  
*Manual edits will be preserved but may be reformatted*  
*See `.memory/README.md` for more information*
